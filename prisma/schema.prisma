datasource db {
  provider = "sqlite" // or "postgresql", "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

/*
ğŸ§ User â†’ can have many Orders
ğŸ§¾ Order â†’ belongs to one User
ğŸ§º Order â†’ can include many Products
ğŸ Product â†’ can belong to many Orders
OrderProduct â†’ join table to store which products belong to which orders and their quantity
*/

// ğŸ§© Enum for order status
enum OrderStatus {
  PENDING
  PROCESSING
  PAID
  SHIPPED
  DELIVERED
  CANCELLED
}


model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  role      String   @default("customer") // or "admin"
  createdAt DateTime @default(now())
  
  // ğŸ‘‡ Relation: 1 User has many Orders
  orders    Order[]
}

model Product {
  id          Int        @id @default(autoincrement())
  name        String
  description String?
  price       Float
  image       String?

// ğŸ‘‡ Relation: A Product can belong to many Orders
  orders      Order[]
}

model Order {
  id         Int        @id @default(autoincrement())
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  status     String     @default("pending")
  total      Float
  user       User?      @relation(fields: [userId], references: [id])
  userId     Int?

  // âœ… Many-to-many (auto)
  products   Product[]
}


model OrderProduct {
  // ğŸ‘‡ Join table for M:N relationship between Orders and Products
  orderId   Int
  productId Int
  quantity  Int        @default(1)

  order     Order      @relation(fields: [orderId], references: [id])
  product   Product    @relation(fields: [productId], references: [id])

  @@id([orderId, productId]) // Composite primary key
}